(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{52:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),o=n(28),a=n.n(o),s=n(12),i=n(2),u=n(8),l=n(10),j=n(11),d=n(4),b=n.n(d),h=new(function(){function e(){Object(l.a)(this,e)}return Object(j.a)(e,[{key:"getBookById",value:function(e){return b.a.get("/books/"+e)}},{key:"getBooks",value:function(e){return b.a.get("/books",{params:e})}},{key:"getBooksBySearch",value:function(e){return b.a.get("/books",{params:e})}},{key:"getBookByGenre",value:function(e){return b.a.get("/books",{params:e})}},{key:"createBook",value:function(e){return b.a.post("/books",e)}},{key:"updateBook",value:function(e){return b.a.put("/books/"+e.id,{title:e.title,authorId:e.authorId,genresId:e.genresId})}},{key:"deleteBook",value:function(e){return b.a.delete("/books/"+e)}}]),e}()),O=(n(52),n(0));var f=function(e){var t=e.book,n=e.onDelete,r=Object(i.f)();return Object(O.jsxs)("div",{className:"bookCont",children:[Object(O.jsx)("button",{className:"buttonLink",onClick:function(){r.push("/book-view/".concat(t.id))},children:Object(O.jsx)("img",{src:"/image"})}),Object(O.jsx)("div",{className:"title",children:t.title}),Object(O.jsxs)("ul",{children:[Object(O.jsxs)("li",{children:["Author: ",t.author.name]}),Object(O.jsxs)("li",{children:["Genres:"," ",t.genres.map((function(e,t){return Object(O.jsxs)("span",{children:[e.name," "]},t)}))]}),Object(O.jsxs)("li",{children:["Comments: ",0===t.commentsCount?"-":t.commentsCount]}),Object(O.jsxs)("li",{children:["Avg.Score: ",0===t.avgScore?"-":Number.parseFloat(t.avgScore).toFixed(1)]})]}),Object(O.jsxs)("div",{className:"edit",children:[Object(O.jsx)("button",{onClick:function(){r.push("/new/".concat(t.id))},children:"Edit"}),Object(O.jsx)("button",{onClick:function(){h.deleteBook(t.id).then((function(e){null===e.data.result||"false"!==e.data.result?n(t.id):r.push("/error")}))},children:"Delete"})]})]})};n(59);var x=function(e){var t=e.pageParams,n=e.onPageChange,r=t.currentPage+1,c=t.maxPages,o=r+1>c?r:r+1,a=r-1<1?r:r-1;return Object(O.jsx)("div",{className:"pagingCont",children:Object(O.jsxs)("ul",{children:[Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n(0)},children:"First"})}),Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n(a-1)},children:"Previous"})}),function(){for(var e=[],t=r-2<1?Math.abs(r-2)+1:0,o=r+2>c?r+2-c:0,a=r+2+t>c?c:r+2+t,s=function(t){e.push(Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n(t-1)},children:t})},t))},i=r-2-o<1?1:r-2-o;i<r;i++)s(i);e.push(Object(O.jsx)("li",{children:Object(O.jsx)("button",{className:"active",onClick:function(){return n(r-1)},children:r})},r));for(var u=function(t){e.push(Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n(t-1)},children:t})},t))},l=r+1;l<a+1;l++)u(l);return e}(),Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n(o-1)},children:"Next"})}),Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n(c-1)},children:"Last"})})]})})},g=(n(60),new(function(){function e(){Object(l.a)(this,e)}return Object(j.a)(e,[{key:"getGenres",value:function(){return b.a.get("/genres")}}]),e}()));var v=function(e){var t=e.onGenreChange,n=e.onSortChange,c=Object(i.f)(),o=Object(r.useState)([]),a=Object(u.a)(o,2),s=a[0],l=a[1];return Object(r.useEffect)((function(){g.getGenres().then((function(e){null===e.data.result||"false"!==e.data.result?l(e.data):c.push("/error")}))}),[]),Object(O.jsx)("div",{className:"bookListNavSort",children:Object(O.jsxs)("ul",{children:[Object(O.jsx)("li",{children:Object(O.jsxs)("select",{onChange:function(e){t(e.target.value)},children:[Object(O.jsx)("option",{value:"null",children:"All"}),s.map((function(e){return Object(O.jsx)("option",{value:e.id,children:e.name},e.id)}))]})}),Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n("NEW")},children:"New"})}),Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n("BEST")},children:"Best"})}),Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n("POPULAR")},children:"Popular"})})]})})};n(61);var m=function(e){var t=e.onSearch;return Object(O.jsx)("div",{className:"searchFormCont",children:Object(O.jsxs)("form",{onSubmit:function(e){return t(e)},children:[Object(O.jsx)("input",{type:"search",placeholder:"Search"}),Object(O.jsx)("button",{type:"submit",children:"Search"})]})})};var k=function(){var e=Object(i.f)(),t=Object(r.useState)({books:[],currentPage:0,maxPages:0,genreId:null,sort:"NEW",qyery:null}),n=Object(u.a)(t,2),c=n[0],o=n[1],a=function(e){null!=c.query?s(c.query,e,c.sort):null!=c.genreId?l(c.genreId,e,c.sort):j(e,c.sort)};Object(r.useEffect)((function(){a(0)}),[]);var s=function(t,n,r){var c={pageNumber:n,pageSize:8,sort:r,query:t};h.getBooksBySearch(c).then((function(c){if(null===c.data.result||"false"!==c.data.result){var a={books:c.data.bookList,currentPage:n,maxPages:c.data.totalPages,genreId:null,sort:r,query:t};o(a)}else e.push("/error")}))},l=function(t,n,r){var c={pageNumber:n,pageSize:8,sort:r,genreId:t};h.getBookByGenre(c).then((function(c){if(null===c.data.result||"false"!==c.data.result){var a={books:c.data.bookList,currentPage:n,maxPages:c.data.totalPages,genreId:t,sort:r,query:null};o(a)}else e.push("/error")}))},j=function(t,n){var r={pageNumber:t,pageSize:8,sort:n};h.getBooks(r).then((function(r){if(null===r.data.result||"false"!==r.data.result){var c={books:r.data.bookList,currentPage:t,maxPages:r.data.totalPages,genreId:null,sort:n,query:null};o(c)}else e.push("/error")}))},d=function(e){var t={books:c.books.filter((function(t){return t.id!=e})),currentPage:c.currentPage,maxPages:c.maxPages,genreId:c.genreId,sort:c.sort,qyery:c.qyery};o(t)};return Object(O.jsxs)("div",{className:"bookListMainCont",children:[Object(O.jsxs)("nav",{className:"bookListNav",children:[Object(O.jsx)(v,{onGenreChange:function(e){"null"==e?j(0,"NEW"):l(e,0,"NEW")},onSortChange:function(e){null!=c.query?s(c.query,c.currentPage,e):null!=c.genreId?l(c.genreId,c.currentPage,e):j(c.currentPage,e)}}),Object(O.jsx)(m,{onSearch:function(e){e&&e.preventDefault();var t=e.target[0].value;t&&s(t,c.currentPage,c.sort)}})]}),Object(O.jsx)("div",{className:"bookListCont",children:c.books.map((function(e){return Object(O.jsx)(f,{book:e,onDelete:d},e.id)}))}),Object(O.jsx)(x,{onPageChange:a,pageParams:{currentPage:c.currentPage,maxPages:c.maxPages}})]})},p=(n(62),new(function(){function e(){Object(l.a)(this,e)}return Object(j.a)(e,[{key:"getComments",value:function(e){return b.a.get("/comments",{params:e})}},{key:"createComment",value:function(e){return b.a.post("/comments",e)}}]),e}()));var C=function(e){var t=e.onCreateComment,n=Object(r.useState)(""),c=Object(u.a)(n,2),o=c[0],a=c[1];return Object(O.jsxs)("div",{className:"add-comment",children:[Object(O.jsx)("div",{children:"Add new..."}),Object(O.jsx)("div",{children:Object(O.jsx)("textarea",{onChange:function(e){return function(e){var t=e.target.value;a(t)}(e)}})}),Object(O.jsx)("div",{children:Object(O.jsx)("button",{onClick:function(){return t(o)},children:"Add"})})]})};var N=function(e){var t,n,c,o=e.id,a=Object(i.f)(),s=Object(r.useState)({comments:[],totalPages:0,currentPage:0}),l=Object(u.a)(s,2),j=l[0],d=l[1],b=function(e){if(o){var t={id:o,pageSize:3,pageNumber:e};p.getComments(t).then((function(t){var n;null===t.data.result||"false"!==t.data.result?(e<=j.currentPage?n=t.data.commentList:(n=j.comments,t.data.commentList.forEach((function(e){return n.push(e)}))),d({comments:n,totalPages:t.data.totalPages,currentPage:e})):a.push("/error")}))}},h=function(){j.currentPage<j.totalPages-1&&b(j.currentPage+1)};return Object(r.useEffect)((function(){return b(0)}),[]),Object(O.jsxs)("div",{className:"comment-cont",children:[j.comments.map((function(e){return Object(O.jsxs)("div",{className:"comment",children:[Object(O.jsxs)("div",{className:"author-cont",children:[Object(O.jsx)("div",{className:"ava-cont",children:Object(O.jsx)("img",{src:"/image"})}),Object(O.jsx)("div",{children:e.username})]}),Object(O.jsx)("div",{children:Object(O.jsx)("textarea",{value:e.text,readOnly:!0})})]},e.id)})),(t=j.comments.length,n=j.currentPage,c=j.totalPages,0===t?Object(O.jsx)("div",{children:"There are no comments"}):n===c-1?Object(O.jsx)("div",{}):Object(O.jsx)("div",{children:Object(O.jsx)("button",{onClick:h,children:"more"})})),Object(O.jsx)(C,{onCreateComment:function(e){p.createComment({id:o,text:e}).then((function(e){return b(0)}))}})]})};var P=function(e){var t=e.scoreCounts,n=e.avgScore,r=t.reduce((function(e,t){return e+t}),0);return Object(O.jsxs)("div",{children:[Object(O.jsx)("div",{children:"Scores"}),Object(O.jsxs)("div",{className:"score-cont",children:["5\xa0",Object(O.jsx)("progress",{max:r,value:t[4]}),"\xa0",t[4]]}),Object(O.jsxs)("div",{className:"score-cont",children:["4\xa0",Object(O.jsx)("progress",{max:r,value:t[3]}),"\xa0",t[3]]}),Object(O.jsxs)("div",{className:"score-cont",children:["3\xa0",Object(O.jsx)("progress",{max:r,value:t[2]}),"\xa0",t[2]]}),Object(O.jsxs)("div",{className:"score-cont",children:["2\xa0",Object(O.jsx)("progress",{max:r,value:t[1]}),"\xa0",t[1]]}),Object(O.jsxs)("div",{className:"score-cont",children:["1\xa0",Object(O.jsx)("progress",{max:r,value:t[0]}),"\xa0",t[0]]}),Object(O.jsxs)("div",{children:["Average: ",n]})]})};var y=function(){var e=Object(i.f)(),t=Object(i.g)().id,n=Object(r.useState)({}),c=Object(u.a)(n,2),o=c[0],a=c[1];return Object(r.useEffect)((function(){h.getBookById(t).then((function(t){null===t.data.result||"false"!==t.data.result?a(t.data):e.push("/error")}))}),[]),Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{className:"book-view-cont",children:[Object(O.jsx)("div",{className:"book-image-cont",children:Object(O.jsx)("img",{src:"/image"})}),Object(O.jsxs)("div",{className:"book-view-details-cont",children:[Object(O.jsxs)("div",{children:["Title: ",o.title&&o.title]}),Object(O.jsxs)("div",{children:["Author: ",o.author&&o.author.name]}),Object(O.jsxs)("div",{children:["Genres: ",o.genres&&o.genres.map((function(e){return Object(O.jsxs)("span",{children:[e.name,"\xa0"]},e.id)}))]}),Object(O.jsx)(P,{scoreCounts:void 0===o.scoreCounts?[0,0,0,0,0]:o.scoreCounts,avgScore:o.avgScore&&o.avgScore})]})]}),Object(O.jsx)(N,{id:t})]})},I=(n(63),new(function(){function e(){Object(l.a)(this,e)}return Object(j.a)(e,[{key:"getAuthors",value:function(){return b.a.get("/authors")}}]),e}()));var S=function(){var e=Object(i.f)(),t=Object(i.g)().id,n={authors:[],genres:[],book:{id:t,title:"",authorId:"",genresId:[]}},c=Object(r.useState)(n),o=Object(u.a)(c,2),a=o[0],s=o[1],l=function(e){var t=a.book,n=e.target.value;!0===e.target.checked?t.genresId.push(e.target.value):t.genresId=t.genres.filter((function(e){return e!==n})),s({authors:a.authors,genres:a.genres,book:t})};return Object(r.useEffect)((function(){return console.log(a),void I.getAuthors().then((function(n){null===n.data.result||"false"!==n.data.result?g.getGenres().then((function(r){if(null===r.data.result||"false"!==r.data.result){t&&h.getBookById(t).then((function(t){if(null===t.data.result||"false"!==t.data.result){var c={id:t.data.id,title:t.data.title,authorId:t.data.author.id,genresId:t.data.genres.map((function(e){return e.id}))};s({authors:n.data,genres:r.data,book:c})}else e.push("/error")}));var c={id:a.book.id,title:a.book.title,authorId:n.data[0].id,genresId:a.book.genresId};s({authors:n.data,genres:r.data,book:c})}else e.push("/error")})):e.push("/error")}))}),[]),Object(O.jsxs)("div",{className:"formCont",children:[Object(O.jsx)("h3",{children:"Create book"}),Object(O.jsxs)("form",{children:[Object(O.jsxs)("div",{className:"formGroup",children:[Object(O.jsx)("label",{children:"Title"}),Object(O.jsx)("input",{placeholder:"Title",type:"text",onChange:function(e){var t=a.book;t.title=e.target.value,s({authors:a.authors,genres:a.genres,book:t})},value:a.book.title})]}),Object(O.jsxs)("div",{className:"formGroup",children:[Object(O.jsx)("label",{children:"Author"}),Object(O.jsx)("select",{onChange:function(e){var t=a.book;t.authorId=e.target.value,console.log(t.authorId),s({authors:a.authors,genres:a.genres,book:t})},value:a.book.authorId,children:a.authors.map((function(e){return Object(O.jsx)("option",{value:e.id,children:e.name},e.id)}))})]}),Object(O.jsxs)("div",{className:"formCheckbox",children:[Object(O.jsx)("label",{children:"Genre"}),a.genres.map((function(e){return Object(O.jsxs)("div",{children:[Object(O.jsx)("input",{type:"checkbox",value:e.id,checked:a.book.genresId.includes(e.id),onChange:l}),Object(O.jsx)("span",{children:e.name})]},e.id)}))]}),Object(O.jsxs)("div",{className:"formGroupAccept",children:[Object(O.jsx)("button",{onClick:function(t){return function(t){t.preventDefault(),a.book.id?h.updateBook(a.book).then((function(){return e.push("/")})):h.createBook(a.book).then((function(){return e.push("/")}))}(t)},children:"Save"}),Object(O.jsx)("button",{onClick:function(t){return function(t){t.preventDefault(),e.push("/")}(t)},children:"Cancel"})]})]})]})};var B=function(){return Object(O.jsx)("div",{children:Object(O.jsx)("h1",{children:"We deeply sorry. It wont happen again! Probably..."})})};n(64);var w=function(){var e=Object(i.f)();return Object(O.jsxs)("header",{children:[Object(O.jsx)("div",{className:"headerTitle",children:Object(O.jsx)("h3",{children:"Book CRUD UI"})}),Object(O.jsxs)("div",{className:"headerNav",children:[Object(O.jsx)("button",{onClick:function(){e.push("/")},children:"View books"}),Object(O.jsx)("button",{onClick:function(){e.push("/new")},children:"Create new"})]})]})};n(65);var E=function(){return Object(O.jsx)("div",{children:Object(O.jsxs)(s.a,{children:[Object(O.jsx)(w,{}),Object(O.jsx)("div",{className:"mainCont",children:Object(O.jsxs)(i.c,{children:[Object(O.jsx)(i.a,{exact:!0,path:"/",component:k}),Object(O.jsx)(i.a,{path:"/new/:id",component:S}),Object(O.jsx)(i.a,{path:"/new/",component:S}),Object(O.jsx)(i.a,{path:"/book-view/:id",component:y}),Object(O.jsx)(i.a,{path:"/error",component:B})]})})]})})};n(66);a.a.render(Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)(E,{})}),document.getElementById("root"))}},[[67,1,2]]]);
//# sourceMappingURL=main.25e83a84.chunk.js.map