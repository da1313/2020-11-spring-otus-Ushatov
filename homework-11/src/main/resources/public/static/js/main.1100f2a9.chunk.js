(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{52:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),o=n(28),s=n.n(o),a=n(12),i=n(2),u=n(8),j=n(10),l=n(11),d=n(4),b=n.n(d),h=new(function(){function e(){Object(j.a)(this,e)}return Object(l.a)(e,[{key:"getBookById",value:function(e){return b.a.get("/books/"+e)}},{key:"getBooks",value:function(e){return b.a.get("/books",{params:e})}},{key:"getBooksBySearch",value:function(e){return b.a.get("/books",{params:e})}},{key:"getBookByGenre",value:function(e){return b.a.get("/books",{params:e})}},{key:"createBook",value:function(e){return b.a.post("/books",e)}},{key:"updateBook",value:function(e){return b.a.put("/books/"+e.id,{title:e.title,authorId:e.authorId,genresId:e.genresId})}},{key:"deleteBook",value:function(e){return b.a.delete("/books/"+e)}}]),e}()),O=(n(52),n(0));var g=function(e){var t=e.book,n=e.onDelete,c=Object(i.f)();return Object(O.jsxs)("div",{className:"bookCont",children:[Object(O.jsx)("button",{className:"buttonLink",onClick:function(){c.push("/book-view/".concat(t.id))},children:Object(O.jsx)("img",{src:"/image"})}),Object(O.jsx)("div",{className:"title",children:t.title}),Object(O.jsxs)("ul",{children:[Object(O.jsxs)("li",{children:["Author: ",t.author.name]}),Object(O.jsxs)("li",{children:["Genres:"," ",t.genres.map((function(e,t){return Object(O.jsxs)("span",{children:[e.name," "]},t)}))]}),Object(O.jsxs)("li",{children:["Comments: ",0===t.commentsCount?"-":t.commentsCount]}),Object(O.jsxs)("li",{children:["Avg.Score: ",0===t.avgScore?"-":Number.parseFloat(t.avgScore).toFixed(1)]})]}),Object(O.jsxs)("div",{className:"edit",children:[Object(O.jsx)("button",{onClick:function(){c.push("/new/".concat(t.id))},children:"Edit"}),Object(O.jsx)("button",{onClick:function(){h.deleteBook(t.id).then((function(e){n(t.id)}))},children:"Delete"})]})]})};n(59);var x=function(e){var t=e.pageParams,n=e.onPageChange,c=t.currentPage+1,r=t.maxPages,o=c+1>r?c:c+1,s=c-1<1?c:c-1;return Object(O.jsx)("div",{className:"pagingCont",children:Object(O.jsxs)("ul",{children:[Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n(0)},children:"First"})}),Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n(s-1)},children:"Previous"})}),function(){for(var e=[],t=c-2<1?Math.abs(c-2)+1:0,o=c+2>r?c+2-r:0,s=c+2+t>r?r:c+2+t,a=function(t){e.push(Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n(t-1)},children:t})},t))},i=c-2-o<1?1:c-2-o;i<c;i++)a(i);e.push(Object(O.jsx)("li",{children:Object(O.jsx)("button",{className:"active",onClick:function(){return n(c-1)},children:c})},c));for(var u=function(t){e.push(Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n(t-1)},children:t})},t))},j=c+1;j<s+1;j++)u(j);return e}(),Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n(o-1)},children:"Next"})}),Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n(r-1)},children:"Last"})})]})})},v=(n(60),new(function(){function e(){Object(j.a)(this,e)}return Object(l.a)(e,[{key:"getGenres",value:function(){return b.a.get("/genres")}}]),e}()));var m=function(e){var t=e.onGenreChange,n=e.onSortChange,r=Object(c.useState)([]),o=Object(u.a)(r,2),s=o[0],a=o[1];return Object(c.useEffect)((function(){v.getGenres().then((function(e){a(e.data)}))}),[]),Object(O.jsx)("div",{className:"bookListNavSort",children:Object(O.jsxs)("ul",{children:[Object(O.jsx)("li",{children:Object(O.jsxs)("select",{onChange:function(e){t(e.target.value)},children:[Object(O.jsx)("option",{value:"null",children:"All"}),s.map((function(e){return Object(O.jsx)("option",{value:e.id,children:e.name},e.id)}))]})}),Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n("NEW")},children:"New"})}),Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n("BEST")},children:"Best"})}),Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:function(){return n("POPULAR")},children:"Popular"})})]})})};n(61);var f=function(e){var t=e.onSearch;return Object(O.jsx)("div",{className:"searchFormCont",children:Object(O.jsxs)("form",{onSubmit:function(e){return t(e)},children:[Object(O.jsx)("input",{type:"search",placeholder:"Search"}),Object(O.jsx)("button",{type:"submit",children:"Search"})]})})};var k=function(){var e=Object(c.useState)({books:[],currentPage:0,maxPages:0,genreId:null,sort:"NEW",qyery:null}),t=Object(u.a)(e,2),n=t[0],r=t[1],o=function(e){null!=n.query?s(n.query,e,n.sort):null!=n.genreId?a(n.genreId,e,n.sort):i(e,n.sort)};Object(c.useEffect)((function(){o(0)}),[]);var s=function(e,t,n){var c={pageNumber:t,pageSize:8,sort:n,query:e};h.getBooksBySearch(c).then((function(c){var o={books:c.data.bookList,currentPage:t,maxPages:c.data.totalPages,genreId:null,sort:n,query:e};r(o)}))},a=function(e,t,n){var c={pageNumber:t,pageSize:8,sort:n,genreId:e};h.getBookByGenre(c).then((function(c){var o={books:c.data.bookList,currentPage:t,maxPages:c.data.totalPages,genreId:e,sort:n,query:null};r(o)}))},i=function(e,t){var n={pageNumber:e,pageSize:8,sort:t};h.getBooks(n).then((function(n){var c={books:n.data.bookList,currentPage:e,maxPages:n.data.totalPages,genreId:null,sort:t,query:null};r(c)}))},j=function(e){var t={books:n.books.filter((function(t){return t.id!=e})),currentPage:n.currentPage,maxPages:n.maxPages,genreId:n.genreId,sort:n.sort,qyery:n.qyery};r(t)};return Object(O.jsxs)("div",{className:"bookListMainCont",children:[Object(O.jsxs)("nav",{className:"bookListNav",children:[Object(O.jsx)(m,{onGenreChange:function(e){"null"==e?i(0,"NEW"):a(e,0,"NEW")},onSortChange:function(e){null!=n.query?s(n.query,n.currentPage,e):null!=n.genreId?a(n.genreId,n.currentPage,e):i(n.currentPage,e)}}),Object(O.jsx)(f,{onSearch:function(e){e&&e.preventDefault();var t=e.target[0].value;t&&s(t,n.currentPage,n.sort)}})]}),Object(O.jsx)("div",{className:"bookListCont",children:n.books.map((function(e){return Object(O.jsx)(g,{book:e,onDelete:j},e.id)}))}),Object(O.jsx)(x,{onPageChange:o,pageParams:{currentPage:n.currentPage,maxPages:n.maxPages}})]})},p=(n(62),new(function(){function e(){Object(j.a)(this,e)}return Object(l.a)(e,[{key:"getComments",value:function(e){return b.a.get("/comments",{params:e})}},{key:"createComment",value:function(e){return b.a.post("/comments",e)}}]),e}()));var C=function(e){var t=e.onCreateComment,n=Object(c.useState)(""),r=Object(u.a)(n,2),o=r[0],s=r[1];return Object(O.jsxs)("div",{className:"add-comment",children:[Object(O.jsx)("div",{children:"Add new..."}),Object(O.jsx)("div",{children:Object(O.jsx)("textarea",{onChange:function(e){return function(e){var t=e.target.value;s(t)}(e)}})}),Object(O.jsx)("div",{children:Object(O.jsx)("button",{onClick:function(){return t(o)},children:"Add"})})]})};var N=function(e){var t,n,r,o=e.id,s=Object(c.useState)({comments:[],totalPages:0,currentPage:0}),a=Object(u.a)(s,2),i=a[0],j=a[1],l=function(e){if(o){var t={id:o,pageSize:3,pageNumber:e};p.getComments(t).then((function(t){var n;e<=i.currentPage?n=t.data.commentList:(n=i.comments,t.data.commentList.forEach((function(e){return n.push(e)}))),j({comments:n,totalPages:t.data.totalPages,currentPage:e})}))}},d=function(){i.currentPage<i.totalPages-1&&l(i.currentPage+1)};return Object(c.useEffect)((function(){return l(0)}),[]),Object(O.jsxs)("div",{className:"comment-cont",children:[i.comments.map((function(e){return Object(O.jsxs)("div",{className:"comment",children:[Object(O.jsxs)("div",{className:"author-cont",children:[Object(O.jsx)("div",{className:"ava-cont",children:Object(O.jsx)("img",{src:"/image"})}),Object(O.jsx)("div",{children:e.username})]}),Object(O.jsx)("div",{children:Object(O.jsx)("textarea",{value:e.text,readOnly:!0})})]},e.id)})),(t=i.comments.length,n=i.currentPage,r=i.totalPages,0===t?Object(O.jsx)("div",{children:"There are no comments"}):n===r-1?Object(O.jsx)("div",{}):Object(O.jsx)("div",{children:Object(O.jsx)("button",{onClick:d,children:"more"})})),Object(O.jsx)(C,{onCreateComment:function(e){p.createComment({id:o,text:e}).then((function(e){return l(0)}))}})]})};var P=function(e){var t=e.scoreCounts,n=e.avgScore,c=t.reduce((function(e,t){return e+t}),0);return Object(O.jsxs)("div",{children:[Object(O.jsx)("div",{children:"Scores"}),Object(O.jsxs)("div",{className:"score-cont",children:["5\xa0",Object(O.jsx)("progress",{max:c,value:t[4]}),"\xa0",t[4]]}),Object(O.jsxs)("div",{className:"score-cont",children:["4\xa0",Object(O.jsx)("progress",{max:c,value:t[3]}),"\xa0",t[3]]}),Object(O.jsxs)("div",{className:"score-cont",children:["3\xa0",Object(O.jsx)("progress",{max:c,value:t[2]}),"\xa0",t[2]]}),Object(O.jsxs)("div",{className:"score-cont",children:["2\xa0",Object(O.jsx)("progress",{max:c,value:t[1]}),"\xa0",t[1]]}),Object(O.jsxs)("div",{className:"score-cont",children:["1\xa0",Object(O.jsx)("progress",{max:c,value:t[0]}),"\xa0",t[0]]}),Object(O.jsxs)("div",{children:["Average: ",n]})]})};var y=function(){var e=Object(i.g)().id,t=Object(c.useState)({}),n=Object(u.a)(t,2),r=n[0],o=n[1];return Object(c.useEffect)((function(){h.getBookById(e).then((function(e){return o(e.data)}))}),[]),Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{className:"book-view-cont",children:[Object(O.jsx)("div",{className:"book-image-cont",children:Object(O.jsx)("img",{src:"/image"})}),Object(O.jsxs)("div",{className:"book-view-details-cont",children:[Object(O.jsxs)("div",{children:["Title: ",r.title&&r.title]}),Object(O.jsxs)("div",{children:["Author: ",r.author&&r.author.name]}),Object(O.jsxs)("div",{children:["Genres: ",r.genres&&r.genres.map((function(e){return Object(O.jsxs)("span",{children:[e.name,"\xa0"]},e.id)}))]}),Object(O.jsx)(P,{scoreCounts:void 0===r.scoreCounts?[0,0,0,0,0]:r.scoreCounts,avgScore:r.avgScore&&r.avgScore})]})]}),Object(O.jsx)(N,{id:e})]})},I=(n(63),new(function(){function e(){Object(j.a)(this,e)}return Object(l.a)(e,[{key:"getAuthors",value:function(){return b.a.get("/authors")}}]),e}()));var S=function(){var e=Object(i.f)(),t=Object(i.g)().id,n={authors:[],genres:[],book:{id:t,title:"",authorId:"",genresId:[]}},r=Object(c.useState)(n),o=Object(u.a)(r,2),s=o[0],a=o[1],j=function(e){var t=s.book,n=e.target.value;!0===e.target.checked?t.genresId.push(e.target.value):t.genresId=t.genres.filter((function(e){return e!==n})),a({authors:s.authors,genres:s.genres,book:t})};return Object(c.useEffect)((function(){return console.log(s),void I.getAuthors().then((function(e){v.getGenres().then((function(n){t&&h.getBookById(t).then((function(t){var c={id:t.data.id,title:t.data.title,authorId:t.data.author.id,genresId:t.data.genres.map((function(e){return e.id}))};a({authors:e.data,genres:n.data,book:c})}));var c={id:s.book.id,title:s.book.title,authorId:e.data[0].id,genresId:s.book.genresId};a({authors:e.data,genres:n.data,book:c})}))}))}),[]),Object(O.jsxs)("div",{className:"formCont",children:[Object(O.jsx)("h3",{children:"Create book"}),Object(O.jsxs)("form",{children:[Object(O.jsxs)("div",{className:"formGroup",children:[Object(O.jsx)("label",{children:"Title"}),Object(O.jsx)("input",{placeholder:"Title",type:"text",onChange:function(e){var t=s.book;t.title=e.target.value,a({authors:s.authors,genres:s.genres,book:t})},value:s.book.title})]}),Object(O.jsxs)("div",{className:"formGroup",children:[Object(O.jsx)("label",{children:"Author"}),Object(O.jsx)("select",{onChange:function(e){var t=s.book;t.authorId=e.target.value,console.log(t.authorId),a({authors:s.authors,genres:s.genres,book:t})},value:s.book.authorId,children:s.authors.map((function(e){return Object(O.jsx)("option",{value:e.id,children:e.name},e.id)}))})]}),Object(O.jsxs)("div",{className:"formCheckbox",children:[Object(O.jsx)("label",{children:"Genre"}),s.genres.map((function(e){return Object(O.jsxs)("div",{children:[Object(O.jsx)("input",{type:"checkbox",value:e.id,checked:s.book.genresId.includes(e.id),onChange:j}),Object(O.jsx)("span",{children:e.name})]},e.id)}))]}),Object(O.jsxs)("div",{className:"formGroupAccept",children:[Object(O.jsx)("button",{onClick:function(t){return function(t){t.preventDefault(),s.book.id?h.updateBook(s.book).then((function(){return e.push("/")})):h.createBook(s.book).then((function(){return e.push("/")}))}(t)},children:"Save"}),Object(O.jsx)("button",{onClick:function(t){return function(t){t.preventDefault(),e.push("/")}(t)},children:"Cancel"})]})]})]})};n(64);var B=function(){var e=Object(i.f)();return Object(O.jsxs)("header",{children:[Object(O.jsx)("div",{className:"headerTitle",children:Object(O.jsx)("h3",{children:"Book CRUD UI"})}),Object(O.jsxs)("div",{className:"headerNav",children:[Object(O.jsx)("button",{onClick:function(){e.push("/")},children:"View books"}),Object(O.jsx)("button",{onClick:function(){e.push("/new")},children:"Create new"})]})]})};n(65);var w=function(){return Object(O.jsx)("div",{children:Object(O.jsxs)(a.a,{children:[Object(O.jsx)(B,{}),Object(O.jsx)("div",{className:"mainCont",children:Object(O.jsxs)(i.c,{children:[Object(O.jsx)(i.a,{exact:!0,path:"/",component:k}),Object(O.jsx)(i.a,{path:"/new/:id",component:S}),Object(O.jsx)(i.a,{path:"/new/",component:S}),Object(O.jsx)(i.a,{path:"/book-view/:id",component:y})]})})]})})};n(66);s.a.render(Object(O.jsx)(r.a.StrictMode,{children:Object(O.jsx)(w,{})}),document.getElementById("root"))}},[[67,1,2]]]);
//# sourceMappingURL=main.1100f2a9.chunk.js.map